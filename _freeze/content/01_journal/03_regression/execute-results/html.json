{
  "hash": "db5cd459c4111df451467322c9faa031",
  "result": {
    "markdown": "---\ntitle: \"Regression and Statistical Inference\"\nauthor: \"Yazan Dabbas\"\ndate: \"12/16/2023\"\nformat: \n    html:\n      code-line-numbers: true\n      df-print: paged\n---\n\n---\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-1_4cc9bb41b8af47b23a3668001ca44945'}\n\n```{.r .cell-code}\n# Load required libraries\nlibrary(dplyr)\nlibrary(modelr)\n```\n:::\n\n\n#### **Load the Data and Check the Dimensions**\n\n----\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-2_4d8836eb07dec817e10053d53133ab34'}\n\n```{.r .cell-code}\ndf <- readRDS(\"C:/Master Degree/Core Qualification_Compulsory Courses/Business/Causal_Data_Science/Data/Causal_Data_Science_Data/car_prices.rds\")\n\n# Be familiar with the data\nhead(df)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"aspiration\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"doornumber\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"carbody\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"drivewheel\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"enginelocation\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"wheelbase\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"carlength\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"carwidth\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"carheight\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"curbweight\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"enginetype\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cylindernumber\"],\"name\":[12],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"enginesize\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fuelsystem\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"boreratio\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"stroke\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"compressionratio\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"horsepower\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"peakrpm\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"citympg\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"highwaympg\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"price\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"std\",\"2\":\"two\",\"3\":\"convertible\",\"4\":\"rwd\",\"5\":\"front\",\"6\":\"88.6\",\"7\":\"168.8\",\"8\":\"64.1\",\"9\":\"48.8\",\"10\":\"2548\",\"11\":\"dohc\",\"12\":\"four\",\"13\":\"130\",\"14\":\"mpfi\",\"15\":\"3.47\",\"16\":\"2.68\",\"17\":\"9.0\",\"18\":\"111\",\"19\":\"5000\",\"20\":\"21\",\"21\":\"27\",\"22\":\"13495\"},{\"1\":\"std\",\"2\":\"two\",\"3\":\"convertible\",\"4\":\"rwd\",\"5\":\"front\",\"6\":\"88.6\",\"7\":\"168.8\",\"8\":\"64.1\",\"9\":\"48.8\",\"10\":\"2548\",\"11\":\"dohc\",\"12\":\"four\",\"13\":\"130\",\"14\":\"mpfi\",\"15\":\"3.47\",\"16\":\"2.68\",\"17\":\"9.0\",\"18\":\"111\",\"19\":\"5000\",\"20\":\"21\",\"21\":\"27\",\"22\":\"16500\"},{\"1\":\"std\",\"2\":\"two\",\"3\":\"hatchback\",\"4\":\"rwd\",\"5\":\"front\",\"6\":\"94.5\",\"7\":\"171.2\",\"8\":\"65.5\",\"9\":\"52.4\",\"10\":\"2823\",\"11\":\"ohcv\",\"12\":\"six\",\"13\":\"152\",\"14\":\"mpfi\",\"15\":\"2.68\",\"16\":\"3.47\",\"17\":\"9.0\",\"18\":\"154\",\"19\":\"5000\",\"20\":\"19\",\"21\":\"26\",\"22\":\"16500\"},{\"1\":\"std\",\"2\":\"four\",\"3\":\"sedan\",\"4\":\"fwd\",\"5\":\"front\",\"6\":\"99.8\",\"7\":\"176.6\",\"8\":\"66.2\",\"9\":\"54.3\",\"10\":\"2337\",\"11\":\"ohc\",\"12\":\"four\",\"13\":\"109\",\"14\":\"mpfi\",\"15\":\"3.19\",\"16\":\"3.40\",\"17\":\"10.0\",\"18\":\"102\",\"19\":\"5500\",\"20\":\"24\",\"21\":\"30\",\"22\":\"13950\"},{\"1\":\"std\",\"2\":\"four\",\"3\":\"sedan\",\"4\":\"4wd\",\"5\":\"front\",\"6\":\"99.4\",\"7\":\"176.6\",\"8\":\"66.4\",\"9\":\"54.3\",\"10\":\"2824\",\"11\":\"ohc\",\"12\":\"five\",\"13\":\"136\",\"14\":\"mpfi\",\"15\":\"3.19\",\"16\":\"3.40\",\"17\":\"8.0\",\"18\":\"115\",\"19\":\"5500\",\"20\":\"18\",\"21\":\"22\",\"22\":\"17450\"},{\"1\":\"std\",\"2\":\"two\",\"3\":\"sedan\",\"4\":\"fwd\",\"5\":\"front\",\"6\":\"99.8\",\"7\":\"177.3\",\"8\":\"66.3\",\"9\":\"53.1\",\"10\":\"2507\",\"11\":\"ohc\",\"12\":\"five\",\"13\":\"136\",\"14\":\"mpfi\",\"15\":\"3.19\",\"16\":\"3.40\",\"17\":\"8.5\",\"18\":\"110\",\"19\":\"5500\",\"20\":\"19\",\"21\":\"25\",\"22\":\"15250\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n#  Check the number of rows and columns \ndim_data <- dim(df)\nrows <- dim_data[1]\ncolumns <- dim_data[2]\n\ncat(\"Rows Number: \", rows, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Rows Number:  181\n```\n:::\n\n```{.r .cell-code}\ncat(\"Columns Number: \", columns, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Columns Number:  22\n```\n:::\n:::\n\n#### **Get a more detailed look at the data**\n\n----\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-3_d9aa80a203159189aa3778c6f16f7ba1'}\n\n```{.r .cell-code}\n ## Check what data type the data has \ncol_names <- lapply(df, colnames)\nfirst_element <- head(df$carwidth, 1)\ncat(\"carwidth's type is \", typeof(first_element), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> carwidth's type is  double\n```\n:::\n\n```{.r .cell-code}\nfirst_element <- head(df$carbody, 1)\ncat(\"carbody's type is \", typeof(first_element), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> carbody's type is  character\n```\n:::\n\n```{.r .cell-code}\ncat(\"Two types in the data: character and double\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Two types in the data: character and double\n```\n:::\n:::\n\n#### **Choose one Regressor `(horsepower)`**\n\n----\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-4_dc4247eecbd5f8ed62e9aebaae28ef72'}\n\n```{.r .cell-code}\n# Display the structure of the data frame\ndf[] <- lapply(df, as.numeric)\ndf %>%\n  # Calculate the correlation matrix\n  cor() %>% \n  # Round the correlation values to 2 decimal places\n  round(2) %>% \n  # Extract the lower triangular part of the matrix\n  Matrix::tril()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> 22 x 22 Matrix of class \"dtrMatrix\"\n#>                  aspiration doornumber carbody drivewheel enginelocation\n#> aspiration             1.00          .       .          .              .\n#> doornumber               NA       1.00       .          .              .\n#> carbody                  NA         NA    1.00          .              .\n#> drivewheel               NA         NA      NA       1.00              .\n#> enginelocation           NA         NA      NA         NA           1.00\n#> wheelbase                NA         NA      NA         NA             NA\n#> carlength                NA         NA      NA         NA             NA\n#> carwidth                 NA         NA      NA         NA             NA\n#> carheight                NA         NA      NA         NA             NA\n#> curbweight               NA         NA      NA         NA             NA\n#> enginetype               NA         NA      NA         NA             NA\n#> cylindernumber           NA         NA      NA         NA             NA\n#> enginesize               NA         NA      NA         NA             NA\n#> fuelsystem               NA         NA      NA         NA             NA\n#> boreratio                NA         NA      NA         NA             NA\n#> stroke                   NA         NA      NA         NA             NA\n#> compressionratio         NA         NA      NA         NA             NA\n#> horsepower               NA         NA      NA         NA             NA\n#> peakrpm                  NA         NA      NA         NA             NA\n#> citympg                  NA         NA      NA         NA             NA\n#> highwaympg               NA         NA      NA         NA             NA\n#> price                    NA         NA      NA         NA             NA\n#>                  wheelbase carlength carwidth carheight curbweight enginetype\n#> aspiration               .         .        .         .          .          .\n#> doornumber               .         .        .         .          .          .\n#> carbody                  .         .        .         .          .          .\n#> drivewheel               .         .        .         .          .          .\n#> enginelocation           .         .        .         .          .          .\n#> wheelbase             1.00         .        .         .          .          .\n#> carlength             0.86      1.00        .         .          .          .\n#> carwidth              0.77      0.83     1.00         .          .          .\n#> carheight             0.54      0.44     0.20      1.00          .          .\n#> curbweight            0.74      0.87     0.85      0.21       1.00          .\n#> enginetype              NA        NA       NA        NA         NA       1.00\n#> cylindernumber          NA        NA       NA        NA         NA         NA\n#> enginesize            0.55      0.68     0.74     -0.02       0.87         NA\n#> fuelsystem              NA        NA       NA        NA         NA         NA\n#> boreratio             0.46      0.60     0.55      0.14       0.64         NA\n#> stroke                0.07      0.07     0.11     -0.15       0.10         NA\n#> compressionratio     -0.26     -0.25    -0.25     -0.05      -0.31         NA\n#> horsepower            0.40      0.60     0.70     -0.09       0.82         NA\n#> peakrpm              -0.22     -0.19    -0.11     -0.15      -0.16         NA\n#> citympg              -0.58     -0.78    -0.74     -0.15      -0.87         NA\n#> highwaympg           -0.63     -0.79    -0.75     -0.18      -0.89         NA\n#> price                 0.56      0.67     0.74      0.07       0.83         NA\n#>                  cylindernumber enginesize fuelsystem boreratio stroke\n#> aspiration                    .          .          .         .      .\n#> doornumber                    .          .          .         .      .\n#> carbody                       .          .          .         .      .\n#> drivewheel                    .          .          .         .      .\n#> enginelocation                .          .          .         .      .\n#> wheelbase                     .          .          .         .      .\n#> carlength                     .          .          .         .      .\n#> carwidth                      .          .          .         .      .\n#> carheight                     .          .          .         .      .\n#> curbweight                    .          .          .         .      .\n#> enginetype                    .          .          .         .      .\n#> cylindernumber             1.00          .          .         .      .\n#> enginesize                   NA       1.00          .         .      .\n#> fuelsystem                   NA         NA       1.00         .      .\n#> boreratio                    NA       0.58         NA      1.00      .\n#> stroke                       NA       0.18         NA     -0.10   1.00\n#> compressionratio             NA      -0.16         NA     -0.20  -0.30\n#> horsepower                   NA       0.85         NA      0.59   0.11\n#> peakrpm                      NA      -0.18         NA     -0.24   0.07\n#> citympg                      NA      -0.74         NA     -0.62  -0.09\n#> highwaympg                   NA      -0.76         NA     -0.61  -0.07\n#> price                        NA       0.89         NA      0.55   0.03\n#>                  compressionratio horsepower peakrpm citympg highwaympg price\n#> aspiration                      .          .       .       .          .     .\n#> doornumber                      .          .       .       .          .     .\n#> carbody                         .          .       .       .          .     .\n#> drivewheel                      .          .       .       .          .     .\n#> enginelocation                  .          .       .       .          .     .\n#> wheelbase                       .          .       .       .          .     .\n#> carlength                       .          .       .       .          .     .\n#> carwidth                        .          .       .       .          .     .\n#> carheight                       .          .       .       .          .     .\n#> curbweight                      .          .       .       .          .     .\n#> enginetype                      .          .       .       .          .     .\n#> cylindernumber                  .          .       .       .          .     .\n#> enginesize                      .          .       .       .          .     .\n#> fuelsystem                      .          .       .       .          .     .\n#> boreratio                       .          .       .       .          .     .\n#> stroke                          .          .       .       .          .     .\n#> compressionratio             1.00          .       .       .          .     .\n#> horsepower                  -0.22       1.00       .       .          .     .\n#> peakrpm                      0.16       0.08    1.00       .          .     .\n#> citympg                      0.44      -0.81    0.03    1.00          .     .\n#> highwaympg                   0.45      -0.78    0.05    0.98       1.00     .\n#> price                       -0.18       0.84   -0.02   -0.74      -0.74  1.00\n```\n:::\n\n```{.r .cell-code}\n  # Explain what data type it is and what values it can take on\n\nfirst_element <- head(df$horsepower, 1)\nmin_value <- min(df$horsepower)\nmax_value <- max(df$horsepower)\ncat(\"The chosen predictor is 'horsepower' with a data type of \", typeof(first_element), \" and a range between \", min_value, \" and \", max_value, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> The chosen predictor is 'horsepower' with a data type of  double  and a range between  48  and  288\n```\n:::\n\n```{.r .cell-code}\ncat(\"It significantly influences the price with a correlation of 84%. The positive correlation indicates that as horsepower increases, the price also increases proportionally.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> It significantly influences the price with a correlation of 84%. The positive correlation indicates that as horsepower increases, the price also increases proportionally.\n```\n:::\n:::\n\n#### **Add `seat_heating` variable to the data**\n\n----\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-5_7120860079680e699bd8653d8f6ba17b'}\n\n```{.r .cell-code}\nseat_heating_add_to_df <- df %>% mutate(seat_heating_all_true = sample(c(TRUE, FALSE), size = nrow(df), replace = TRUE))\n\n# Check the distribution of seat_heating_all_true\ntable(seat_heating_add_to_df$seat_heating_all_true)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> FALSE  TRUE \n#>    87    94\n```\n:::\n\n```{.r .cell-code}\n# Run the regression \nmodel <- lm(price ~ seat_heating_all_true, data = seat_heating_add_to_df)\n\n# Print the summary of the model\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = price ~ seat_heating_all_true, data = seat_heating_add_to_df)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#>  -8398  -5256  -2771   2949  33091 \n#> \n#> Coefficients:\n#>                           Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                  13746        864  15.910   <2e-16 ***\n#> seat_heating_all_trueTRUE    -1437       1199  -1.199    0.232    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 8058 on 179 degrees of freedom\n#> Multiple R-squared:  0.007962,\tAdjusted R-squared:  0.00242 \n#> F-statistic: 1.437 on 1 and 179 DF,  p-value: 0.2323\n```\n:::\n:::\n::: {.callout-important appearance=\"minimal\"}\n\n-   **Assigning all values for `seat_heating` as true may result in no variation. This can cause challenges in regression analysis, such as collinearity and difficulty estimating coefficients..**\n\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}